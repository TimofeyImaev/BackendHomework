"""
–í–û–ü–†–û–°: await –¥–µ–ª–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ?

–í—ã –ø—Ä–∞–≤—ã! await –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
await —Ä–∞–±–æ—Ç–∞–µ—Ç –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Future –¥–ª—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏.
"""

import asyncio
import time

# ============================================
# –¢–ï–°–¢ 1: await - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
# ============================================
print("=" * 70)
print("–¢–ï–°–¢ 1: await - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ")
print("=" * 70)
print()

async def task1():
    print(f"[{time.time():.2f}] task1: –Ω–∞—á–∞–ª")
    await asyncio.sleep(1)  # –ñ–¥–µ–º 1 —Å–µ–∫
    print(f"[{time.time():.2f}] task1: –∑–∞–≤–µ—Ä—à–∏–ª")
    return 1

async def task2():
    print(f"[{time.time():.2f}] task2: –Ω–∞—á–∞–ª")
    await asyncio.sleep(0.5)  # –ñ–¥–µ–º 0.5 —Å–µ–∫
    print(f"[{time.time():.2f}] task2: –∑–∞–≤–µ—Ä—à–∏–ª")
    return 2

async def sequential():
    """await –¥–µ–ª–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ"""
    print("=== –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ await ===")
    start = time.time()
    
    # await –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task!
    # –ö–æ—Ä—É—Ç–∏–Ω—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û
    result1 = await task1()  # –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    result2 = await task2()  # –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –Ω–∞—á–∏–Ω–∞–µ–º
    
    elapsed = time.time() - start
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: [{result1}, {result2}]")
    print(f"–í—Ä–µ–º—è: {elapsed:.2f} —Å–µ–∫ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ!)")
    print()

# ============================================
# –¢–ï–°–¢ 2: create_task - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
# ============================================
async def parallel():
    """create_task —Å–æ–∑–¥–∞–µ—Ç Task –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"""
    print("=== –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ create_task ===")
    start = time.time()
    
    # create_task –°–û–ó–î–ê–ï–¢ Task!
    # –ö–æ—Ä—É—Ç–∏–Ω—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û
    t1 = asyncio.create_task(task1())
    t2 = asyncio.create_task(task2())
    
    result1 = await t1
    result2 = await t2
    
    elapsed = time.time() - start
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: [{result1}, {result2}]")
    print(f"–í—Ä–µ–º—è: {elapsed:.2f} —Å–µ–∫ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!)")
    print()

# ============================================
# –¢–ï–°–¢ 3: await –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task
# ============================================
print("=" * 70)
print("–¢–ï–°–¢ 3: await –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task")
print("=" * 70)
print()

# –°—á–µ—Ç—á–∏–∫ —Å–æ–∑–¥–∞–Ω–∏—è Task
task_count = 0
original_create_task = asyncio.create_task

def traced_create_task(coro, name=None):
    global task_count
    task_count += 1
    print(f"üì¶ Task #{task_count} —Å–æ–∑–¥–∞–Ω: {coro}")
    return original_create_task(coro, name=name)

asyncio.create_task = traced_create_task

async def test_no_task_creation():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ await –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task"""
    print("–í—ã–∑—ã–≤–∞–µ–º await task1() –∏ await task2()")
    print("–û–∂–∏–¥–∞–Ω–∏–µ: Task –ù–ï —Å–æ–∑–¥–∞—Å—Ç—Å—è (await –Ω–µ —Å–æ–∑–¥–∞–µ—Ç Task)")
    print()
    
    result1 = await task1()
    result2 = await task2()
    
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: [{result1}, {result2}]")
    print(f"–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ Task: {task_count}")

print("–ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç:")
asyncio.run(test_no_task_creation())
print()

# ============================================
# –¢–ï–°–¢ 4: await –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Future, –Ω–æ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç Task
# ============================================
print("=" * 70)
print("–¢–ï–°–¢ 4: await –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Future, –Ω–æ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç Task")
print("=" * 70)
print()

print("–ö–æ–≥–¥–∞ –º—ã –¥–µ–ª–∞–µ–º: await asyncio.sleep(1)")
print()
print("1. asyncio.sleep(1) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É")
print("2. await –≤—ã–∑—ã–≤–∞–µ—Ç sleep_coro.__await__()")
print("3. __await__() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Future (—Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤–Ω—É—Ç—Ä–∏ sleep)")
print("4. Task.__step() –ø–æ–ª—É—á–∞–µ—Ç Future")
print("5. Task –∂–¥–µ—Ç Future —á–µ—Ä–µ–∑ callback")
print()
print("‚Üí await –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task!")
print("‚Üí await –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Future –¥–ª—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏")
print("‚Üí Future —Å–æ–∑–¥–∞–µ—Ç—Å—è –í–ù–£–¢–†–ò –∫–æ—Ä—É—Ç–∏–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ asyncio.sleep())")
print()

# ============================================
# –í–´–í–û–î
# ============================================
print("=" * 70)
print("–í–´–í–û–î")
print("=" * 70)
print()

print("‚úÖ await –¥–µ–ª–∞–µ—Ç –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–ï –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ")
print("   - await coro() –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task")
print("   - –ö–æ—Ä—É—Ç–∏–Ω—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–Ω–∞ –∑–∞ –¥—Ä—É–≥–æ–π")
print()
print("‚úÖ await –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Future –¥–ª—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏")
print("   - Future —Å–æ–∑–¥–∞–µ—Ç—Å—è –í–ù–£–¢–†–ò –∫–æ—Ä—É—Ç–∏–Ω—ã")
print("   - await –∂–¥–µ—Ç Future —á–µ—Ä–µ–∑ callback")
print("   - Event loop —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π")
print()
print("‚úÖ Task —Å–æ–∑–¥–∞–µ—Ç—Å—è –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ create_task()")
print("   - create_task() —Å–æ–∑–¥–∞–µ—Ç Task –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
print("   - await —Å–∞–º –ø–æ —Å–µ–±–µ –ù–ï —Å–æ–∑–¥–∞–µ—Ç Task")
print()
print("üîë –ö–õ–Æ–ß–ï–í–û–ï –ü–û–ù–ò–ú–ê–ù–ò–ï:")
print("   await = –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ + Future –¥–ª—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∏")
print("   create_task = —Å–æ–∑–¥–∞–Ω–∏–µ Task –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")



























